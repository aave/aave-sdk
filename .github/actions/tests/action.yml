name: 'Test Workflow'
description: 'Run tests against a specified environment'

inputs:
  environment:
    description: 'Environment to run tests against'
    required: true
    default: 'staging'
  private_key:
    description: 'EVM private key of a wallet'
    required: true
  
runs:
  using: 'composite'
  steps:
    - uses: actions/checkout@v4

    - name: Setup Repository
      uses: ./.github/actions/setup

    - name: Build
      shell: bash
      run: pnpm build

    - name: Setup Environment Variables
      shell: bash
      run: |
        echo "PRIVATE_KEY=${{ inputs.private_key }}" >> .env
        echo "ENVIRONMENT=${{ inputs.environment }}" >> .env


    - name: Run Tests
      shell: bash
      run: pnpm test
